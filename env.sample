##
# env.sample
#
# Copy this file to .env and update the values as needed.
#

#
# When SETUP_MODE is 'true' the application will make the first registered
# user a full administrator. After you've created the first (admin) user,
# change SETUP_MODE to 'false' and restart the app.
SETUP_MODE=true

#
# This hsould be true when you run the app for the first time, so you can
# create an administrator user account. Once you've got an administrator
# account, you can set this to false if you don't want members of the public
# signing up.
#
REGISTRATION_ENABLED=true

#
# Basic rate limiting for unauthenticated API requests.
#
UNAUTH_SEARCH_LIMIT_PER_SECOND=1

#
# Server Configuration. If you run the app behind a reverse-proxy, change
# BASE_URL to the public-facing URL.
#
HTTP_LISTEN_PORT=3000
BASE_URL=https://localhost:3000

#
# Security: Skip startup file permission checks (NOT RECOMMENDED)
# By default, VULNZ checks that .env has 0600 permissions to prevent
# other users from reading secrets. Set to 'true' to disable this check.
#
# SKIP_STARTUP_FILEMODE_CHECKS=false

CRON_ENABLE=true

#
# Session Secret - REQUIRED
# A cryptographically secure random string used to sign session cookies.
# MUST be at least 32 characters long. Use a random string generator or run:
#   bash scripts/generate-session-secret.sh
# This will automatically generate and save a secure 48-character secret.
#
SESSION_SECRET=CREATE_A_RANDOM_STRING_HERE

SESSION_DURATION_DAYS=3
LIST_PAGE_SIZE=10
MAX_API_KEYS_PER_USER=10
EXAMPLE_WP_COMPONENT_SLUG=woocommerce
EXAMPLE_WP_COMPONENT_VERSION=10.0.0
API_LOG_RETENTION_DAYS=7

# Database Configuration
DB_HOST=localhost
DB_USER='YOUR_DB_USER_HERE'
DB_PASSWORD='YOUR_DB_PASSWORD_HERE'
DB_NAME='YOUR_DB_NAME_HERE'

# Password Strength
PASSWORD_MIN_LENGTH=8
PASSWORD_MIN_ALPHA=1
PASSWORD_MIN_SYMBOLS=1
PASSWORD_MIN_NUMERIC=1
PASSWORD_MIN_UPPERCASE=1
PASSWORD_MIN_LOWERCASE=1
PASSWORD_RESET_TOKEN_DURATION=3600

# Email Configuration
SMTP_HOST=YOUR_SMTP_HOST_HERE
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER='YOUR_SMTP_USER_HERE'
SMTP_PASS='YOUR_SMTP_PASSWORD_HERE'
SMTP_FROM="VULNZ <noreply@example.com>"

# Reporting. The day-of-week is control per-user within the app.
# Local time, 0-23
REPORTING_HOUR=9
# Maximum number of user reports to email out in one batch. This should be fairly small (e.g. 5-20).
REPORTING_BATCH_SIZE=5
# Email Content
# REPORTING_HEADING='Weekly Website Vulnerability Report'
# REPORTING_OPENING_PARAGRAPH='Here is the weekly vulnerability report of plugins for your hosted WordPress sites.'
# REPORTING_CLOSING_PARAGRAPH='Most vulnerabilities are due to premium plugins that cannot auto-update, or plugins that have been abandoned by their developers. Please ensure you keep all your WordPress components up to date to reduce the risk of compromise.'
# REPORTING_SIGN_OFF='Paul / Headwall Hosting'
# REPORTING_POST_SCRIPT='If you have any questions, you can reply directly to this email.'


# Interacting with wordpress.org
WPORG_UPDATE_BATCH_SIZE=10
WPORG_API_BASE_URL=https://api.wordpress.org
WPORG_PLUGIN_INFO_ENDPOINT=/plugins/info/1.0/
WPORG_THEME_INFO_ENDPOINT=/themes/info/1.0/
WPORG_TIMEOUT_MS=5000
WPORG_USER_AGENT=VULNZ/1.0 (+https://vulnz.headwall.net)
# Re-sync threshold: Plugins not synced in this many days will be re-synced
# Cron job runs daily at 2am to invalidate stale syncs (default: 7 days)
WPORG_RESYNC_DAYS=7

# Logging Configuration debug|info|warn|error
LOG_LEVEL=info

# Automatic Stale Website Deletion
# Websites that haven't been updated in WEBSITE_AUTO_DELETE_DAYS will be
# automatically deleted. This helps keep the database clean when clients
# decommission infrastructure or stop using VULNZ.
#
# IMPORTANT: Leave WEBSITE_AUTO_DELETE_ENABLED=false initially to monitor
# updated_at timestamps. Enable only after verifying the behavior.
#
WEBSITE_AUTO_DELETE_ENABLED=false
WEBSITE_AUTO_DELETE_DAYS=30

# Security Events Configuration
# Path to MaxMind GeoIP database files (GeoLite2-City.mmdb or GeoLite2-Country.mmdb)
# Most hosting providers have these in /var/lib/GeoIP/
# Download from: https://github.com/P3TERX/GeoLite.mmdb
#
GEOIP_DATABASE_PATH=/var/lib/GeoIP

# Security events retention period in days
# Events older than this will be automatically purged to comply with data retention policies
# Default: 30 days (recommended for GDPR compliance)
#
SECURITY_EVENTS_RETENTION_DAYS=30

# Version Tracking Configuration
# Current stable/recommended versions for comparison and reporting
# Update these when new versions are released
#
WORDPRESS_STABLE_VERSION=6.4.2
PHP_MINIMUM_VERSION=8.1.0
PHP_RECOMMENDED_VERSION=8.3.0
MARIADB_MINIMUM_VERSION=10.6.0
MYSQL_MINIMUM_VERSION=8.0.0

# Static Analysis / File Security Issues Configuration
# Retention period for file security issues in days
# Issues not seen in scans for this many days will be purged
# Default: 30 days
#
FILE_SECURITY_ISSUES_RETENTION_DAYS=30

# Component Changes Configuration
# Retention period for component change history in days
# Changes older than this will be purged to manage database size
# Default: 365 days (1 year - useful for long-term audit trails)
#
COMPONENT_CHANGES_RETENTION_DAYS=365

# Plugin Monitoring Configuration
# Thresholds for identifying plugins that may need attention in reports
#
# Unmaintained threshold: Plugins not updated in this many months
# are flagged as potentially abandoned (default: 6 months)
#
PLUGIN_UNMAINTAINED_THRESHOLD_MONTHS=6
#
# Newly published threshold: Plugins published within this many months
# are flagged as newly developed and may need extra scrutiny (default: 3 months)
#
PLUGIN_NEWLY_PUBLISHED_THRESHOLD_MONTHS=3

# Reference Data Configuration
# Automatically update version thresholds and other reference settings
# from a trusted source (checked twice daily at 11am and 11pm GMT)
#
# Method: url|file|disabled
# - url: Fetch from a remote URL (production)
# - file: Load from local file (development/testing)
# - disabled: Don't update reference data automatically
#
REFERENCE_UPDATE_METHOD=file
REFERENCE_UPDATE_LOCATION=./data/reference.json
#
# For production, use:
# REFERENCE_UPDATE_METHOD=url
# REFERENCE_UPDATE_LOCATION=https://vulnz.net/reference.json
