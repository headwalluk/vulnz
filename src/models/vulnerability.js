const db = require('../db');

async function createTable() {
  const sql = `
    CREATE TABLE IF NOT EXISTS vulnerabilities (
      id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
      release_id BIGINT UNSIGNED NOT NULL,
      url VARCHAR(255) NOT NULL,
      FOREIGN KEY (release_id) REFERENCES releases(id) ON DELETE CASCADE,
      UNIQUE KEY \`release_id_url_unique\` (\`release_id\`, \`url\`)
    )
  `;
  await db.query(sql);
}

module.exports = {
  createTable,
};
